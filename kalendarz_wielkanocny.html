<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Kalendarz Wielkanocny</title>
  <style>
    /* Twój styl CSS pozostaje bez zmian */
  </style>
</head>
<body>
  <h1>Kalendarz Wielkanocny</h1>
  <div class="calendar" id="calendar"></div>
  <button id="resetBtn">Resetuj</button>

  <div id="modal">
    <div id="modalContent"></div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const calendar = document.getElementById('calendar');
      const modal = document.getElementById('modal');
      const modalContent = document.getElementById('modalContent');
      const resetBtn = document.getElementById('resetBtn');

      let openedEggs = [];

      // Funkcja do odczytu danych z localStorage
      function loadOpenedEggs() {
        const data = localStorage.getItem('openedEggs');
        if (data) {
          try {
            openedEggs = JSON.parse(data);
          } catch (e) {
            console.error('Błąd podczas parsowania danych z localStorage:', e);
            openedEggs = [];
          }
        }
      }

      // Funkcja do zapisu danych do localStorage
      function saveOpenedEggs() {
        try {
          localStorage.setItem('openedEggs', JSON.stringify(openedEggs));
        } catch (e) {
          console.error('Błąd podczas zapisu danych do localStorage:', e);
        }
      }

      // Funkcja do otwierania modala
      function openModal(content) {
        modalContent.innerHTML = content;
        modal.style.display = 'flex';
      }

      // Funkcja do zamykania modala
      function closeModal() {
        modal.style.display = 'none';
      }

      modal.addEventListener('click', closeModal);

      // Funkcja do generowania losowego wzoru
      function getRandomPattern() {
        const colors = ['#ff9999', '#ffcc99', '#ffff99', '#ccff99', '#99ffcc', '#99ccff', '#cc99ff'];
        const selected = [];
        while (selected.length < 3) {
          const c = colors[Math.floor(Math.random() * colors.length)];
          if (!selected.includes(c)) selected.push(c);
        }
        return `repeating-linear-gradient(45deg, ${selected[0]}, ${selected[0]} 10px, ${selected[1]} 10px, ${selected[1]} 20px, ${selected[2]} 20px, ${selected[2]} 30px)`;
      }

      // Funkcja do renderowania kalendarza
      function renderCalendar() {
        calendar.innerHTML = '';

        const messages = [
          `<p>Wesołych Świąt!</p>`,
          `<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4c/Chocolate_easter_eggs.jpg/320px-Chocolate_easter_eggs.jpg" alt="Easter Image" style="max-width:100%">`,
          `<p>Zajączek już tu był!</p>`,
          `<p>Miłego dnia!</p>`,
          `<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d0/Easter_bunny_and_eggs.jpg/320px-Easter_bunny_and_eggs.jpg" alt="Zajączek" style="max-width:100%">`,
          `<p>Czekoladowe jajko czeka!</p>`
          // Dodaj więcej wiadomości dla jajek 7–30
        ];

        for (let i = 0; i < 30; i++) {
          const egg = document.createElement('button');
          egg.className = 'egg';
          egg.setAttribute('data-egg-id', i);

          const shell = document.createElement('div');
          shell.className = 'shell';

          const topHalf = document.createElement('div');
          topHalf.className = 'top';
          topHalf.style.background = getRandomPattern();

          const bottomHalf = document.createElement('div');
          bottomHalf.className = 'bottom';
          bottomHalf.style.background = topHalf.style.background;

          const chick = document.createElement('div');
          chick.className = 'chick';
          chick.innerText = '🐥';

          shell.appendChild(topHalf);
          shell.appendChild(bottomHalf);
          egg.appendChild(shell);
          egg.appendChild(chick);

          if (openedEggs.includes(i)) {
            egg.classList.add('opened');
          }

          egg.addEventListener('click', () => {
            if (!openedEggs.includes(i)) {
              openedEggs.push(i);
              egg.classList.add('opened');
              saveOpenedEggs();
            }
            openModal(messages[i] || `<p>Brak wiadomości dla jajka ${i + 1}</p>`);
          });

          calendar.appendChild(egg);
        }
      }

      // Obsługa przycisku resetowania
      resetBtn.addEventListener('click', () => {
        localStorage.removeItem('openedEggs');
        openedEggs = [];
        renderCalendar();
      });

      // Inicjalizacja
      loadOpenedEggs();
      renderCalendar();
    });
  </script>
</body>
</html>
